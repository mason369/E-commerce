{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport QRcode from \"qrcode\";\nexport default {\n  name: \"Pay\",\n  data() {\n    return {\n      payInfo: {},\n      timer: null,\n      //支付状态码\n      code: \"\"\n    };\n  },\n  computed: {\n    orderId() {\n      return this.$route.query.orderId;\n    }\n  },\n  mounted() {\n    // 别再生命周期函威中async | await\n    this.getPayInfo();\n  },\n  methods: {\n    async getPayInfo() {\n      let result = await this.$API.reqPayInfo(this.orderId);\n      //如果成功:组件当中存储支付信息\n      if (result.code == 200) {\n        this.payInfo = result.data;\n      }\n    },\n    //获取支付信息\n    //弹出框\n    async open() {\n      //生成二维码\n      let url = await QRcode.toDataURL(this.payInfo.codeUrl);\n      this.$alert(`<img src=${url} />`, \"微信支付\", {\n        dangerouslyUseHTMLString: true,\n        //居中\n        center: true,\n        //是否显示取消\n        showCancelButton: true,\n        cancelButtonText: \"支付遇见问题\",\n        confirmButtonText: \"已支付成功\",\n        showClose: false,\n        //右上角X\n        //关闭弹出框\n        beforeClose: (type, instance, done) => {\n          //type:区分取消|确定按钮\n          // instance:当前组件实例\n          // done:关闭弹出框的方法\n          if (type == \"cancel\") {\n            alert(\"请联系管理员\");\n            //清除定时器\n            clearInterval(this.timer);\n            this.timer = null;\n            //关闭弹出框\n            done();\n          } else {\n            //判断是否真的支付\n            // if (this.code==200) {\n            clearInterval(this.timer);\n            this.timer = null;\n            done();\n            this.$router.push('/paysuccess');\n            // }\n          }\n        }\n      });\n      //支付成功,路由的跳转,如果支付失败，提示信息\n      if (!this.timer) {\n        this.timer = setInterval(async () => {\n          //获取用户支付状态\n          let result = await this.$API.reqPayStatus(this.orderId);\n          if (result.code == 200) {\n            //清除定时器\n            clearInterval(this.timer);\n            this.timer = null;\n            //保存支付成功的code\n            this.code = result.code;\n            //关闭弹出框\n            this.$msgbox.close();\n            //跳转\n            this.$router.push(\"/paysuccess\");\n          }\n        }, 1000);\n      }\n    }\n  }\n};","map":{"version":3,"mappings":";AAuFA;AAEA;EACAA;EACAC;IACA;MACAC;MACAC;MACA;MACAC;IACA;EACA;EACAC;IACAC;MACA;IACA;EACA;EACAC;IACA;IACA;EACA;EACAC;IACA;MACA;MACA;MACA;QACA;MACA;IACA;IACA;IACA;IACA;MACA;MACA;MACA;QACAC;QACA;QACAC;QACA;QACAC;QACAC;QACAC;QACAC;QAAA;QACA;QACAC;UACA;UACA;UACA;UACA;YACAC;YACA;YACAC;YACA;YACA;YACAC;UACA;YACA;YACA;YACAD;YACA;YACAC;YACA;YACA;UACA;QACA;MACA;MACA;MACA;QACA;UACA;UACA;UACA;YACA;YACAD;YACA;YACA;YACA;YACA;YACA;YACA;YACA;UACA;QACA;MACA;IACA;EACA;AACA","names":["name","data","payInfo","timer","code","computed","orderId","mounted","methods","dangerouslyUseHTMLString","center","showCancelButton","cancelButtonText","confirmButtonText","showClose","beforeClose","alert","clearInterval","done"],"sourceRoot":"src/pages/Pay","sources":["index.vue"],"sourcesContent":["<template>\r\n    <div class=\"pay-main\">\r\n        <div class=\"pay-container\">\r\n            <div class=\"checkout-tit\">\r\n                <h4 class=\"tit-txt\">\r\n                    <span class=\"success-icon\"></span>\r\n                    <span class=\"success-info\">订单提交成功，请您及时付款，以便尽快为您发货~~</span>\r\n                </h4>\r\n                <div class=\"paymark\">\r\n                    <span class=\"fl\"\r\n                        >请您在提交订单<em class=\"orange time\">4小时</em>之内完成支付，超时订单会自动取消。订单号：<em\r\n                            >{{ orderId }}</em\r\n                        ></span\r\n                    >\r\n                    <span class=\"fr\"\r\n                        ><em class=\"lead\">应付金额：</em><em class=\"orange money\">￥{{ payInfo.totalFee }}</em></span\r\n                    >\r\n                </div>\r\n            </div>\r\n            <div class=\"checkout-info\">\r\n                <h4>重要说明：</h4>\r\n                <ol>\r\n                    <li>尚品汇商城支付平台目前支持<span class=\"zfb\">支付宝</span>支付方式。</li>\r\n                    <li>其它支付渠道正在调试中，敬请期待。</li>\r\n                    <li>为了保证您的购物支付流程顺利完成，请保存以下支付宝信息。</li>\r\n                </ol>\r\n                <h4>支付宝账户信息：（很重要，<span class=\"save\">请保存！！！</span>）</h4>\r\n                <ul>\r\n                    <li>支付帐号：11111111</li>\r\n                    <li>密码：111111</li>\r\n                    <li>支付密码：111111</li>\r\n                </ul>\r\n            </div>\r\n            <div class=\"checkout-steps\">\r\n                <div class=\"step-tit\">\r\n                    <h5>支付平台</h5>\r\n                </div>\r\n                <div class=\"step-cont\">\r\n                    <ul class=\"payType\">\r\n                        <li><img src=\"./images/pay2.jpg\" /></li>\r\n                        <li><img src=\"./images/pay3.jpg\" /></li>\r\n                    </ul>\r\n                </div>\r\n                <div class=\"hr\"></div>\r\n\r\n                <div class=\"payshipInfo\">\r\n                    <div class=\"step-tit\">\r\n                        <h5>支付网银</h5>\r\n                    </div>\r\n                    <div class=\"step-cont\">\r\n                        <ul class=\"payType\">\r\n                            <li><img src=\"./images/pay10.jpg\" /></li>\r\n                            <li><img src=\"./images/pay11.jpg\" /></li>\r\n                            <li><img src=\"./images/pay12.jpg\" /></li>\r\n                            <li><img src=\"./images/pay13.jpg\" /></li>\r\n                            <li><img src=\"./images/pay14.jpg\" /></li>\r\n                            <li><img src=\"./images/pay15.jpg\" /></li>\r\n                            <li><img src=\"./images/pay16.jpg\" /></li>\r\n                            <li><img src=\"./images/pay17.jpg\" /></li>\r\n                            <li><img src=\"./images/pay18.jpg\" /></li>\r\n                            <li><img src=\"./images/pay19.jpg\" /></li>\r\n                            <li><img src=\"./images/pay20.jpg\" /></li>\r\n                            <li><img src=\"./images/pay21.jpg\" /></li>\r\n                            <li><img src=\"./images/pay22.jpg\" /></li>\r\n                        </ul>\r\n                    </div>\r\n                </div>\r\n                <div class=\"hr\"></div>\r\n\r\n                <div class=\"submit\">\r\n                    <a class=\"btn\" @click=\"open\">立即支付</a>\r\n                </div>\r\n                <div class=\"otherpay\">\r\n                    <div class=\"step-tit\">\r\n                        <h5>其他支付方式</h5>\r\n                    </div>\r\n                    <div class=\"step-cont\">\r\n                        <span><a href=\"weixinpay.html\" target=\"_blank\">微信支付</a></span>\r\n                        <span>中国银联</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport QRcode from \"qrcode\";\r\n\r\nexport default {\r\n    name: \"Pay\",\r\n    data() {\r\n        return {\r\n            payInfo: {},\r\n            timer: null,\r\n            //支付状态码\r\n            code: \"\",\r\n        };\r\n    },\r\n    computed: {\r\n        orderId() {\r\n            return this.$route.query.orderId;\r\n        },\r\n    },\r\n    mounted() {\r\n        // 别再生命周期函威中async | await\r\n        this.getPayInfo();\r\n    },\r\n    methods: {\r\n        async getPayInfo() {\r\n            let result = await this.$API.reqPayInfo(this.orderId);\r\n            //如果成功:组件当中存储支付信息\r\n            if (result.code == 200) {\r\n                this.payInfo = result.data;\r\n            }\r\n        },\r\n        //获取支付信息\r\n        //弹出框\r\n        async open() {\r\n            //生成二维码\r\n            let url = await QRcode.toDataURL(this.payInfo.codeUrl);\r\n            this.$alert(`<img src=${url} />`, \"微信支付\", {\r\n                dangerouslyUseHTMLString: true,\r\n                //居中\r\n                center: true,\r\n                //是否显示取消\r\n                showCancelButton: true,\r\n                cancelButtonText: \"支付遇见问题\",\r\n                confirmButtonText: \"已支付成功\",\r\n                showClose: false, //右上角X\r\n                //关闭弹出框\r\n                beforeClose: (type, instance, done) => {\r\n                    //type:区分取消|确定按钮\r\n                    // instance:当前组件实例\r\n                    // done:关闭弹出框的方法\r\n                    if (type == \"cancel\") {\r\n                        alert(\"请联系管理员\");\r\n                        //清除定时器\r\n                        clearInterval(this.timer);\r\n                        this.timer = null;\r\n                        //关闭弹出框\r\n                        done();\r\n                    } else {\r\n                        //判断是否真的支付\r\n                        // if (this.code==200) {\r\n                            clearInterval(this.timer);\r\n                            this.timer = null;\r\n                            done()\r\n                          this.$router.push('/paysuccess')\r\n                        // }\r\n                    }\r\n                },\r\n            });\r\n            //支付成功,路由的跳转,如果支付失败，提示信息\r\n            if (!this.timer) {\r\n                this.timer = setInterval(async () => {\r\n                    //获取用户支付状态\r\n                    let result = await this.$API.reqPayStatus(this.orderId);\r\n                    if (result.code == 200) {\r\n                        //清除定时器\r\n                        clearInterval(this.timer);\r\n                        this.timer = null;\r\n                        //保存支付成功的code\r\n                        this.code = result.code;\r\n                        //关闭弹出框\r\n                        this.$msgbox.close();\r\n                        //跳转\r\n                        this.$router.push(\"/paysuccess\");\r\n                    }\r\n                }, 1000);\r\n            }\r\n        },\r\n    },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.pay-main {\r\n    margin-bottom: 20px;\r\n\r\n    .pay-container {\r\n        margin: 0 auto;\r\n        width: 1200px;\r\n\r\n        a:hover {\r\n            color: #4cb9fc;\r\n        }\r\n\r\n        .orange {\r\n            color: #e1251b;\r\n        }\r\n\r\n        .money {\r\n            font-size: 18px;\r\n        }\r\n\r\n        .zfb {\r\n            color: #e1251b;\r\n            font-weight: 700;\r\n        }\r\n\r\n        .checkout-tit {\r\n            padding: 10px;\r\n\r\n            .tit-txt {\r\n                font-size: 14px;\r\n                line-height: 21px;\r\n\r\n                .success-icon {\r\n                    width: 30px;\r\n                    height: 30px;\r\n                    display: inline-block;\r\n                    background: url(./images/icon.png) no-repeat 0 0;\r\n                }\r\n\r\n                .success-info {\r\n                    padding: 0 8px;\r\n                    line-height: 30px;\r\n                    vertical-align: top;\r\n                }\r\n            }\r\n\r\n            .paymark {\r\n                overflow: hidden;\r\n                line-height: 26px;\r\n                text-indent: 38px;\r\n\r\n                .fl {\r\n                    float: left;\r\n                }\r\n\r\n                .fr {\r\n                    float: right;\r\n\r\n                    .lead {\r\n                        margin-bottom: 18px;\r\n                        font-size: 15px;\r\n                        font-weight: 400;\r\n                        line-height: 22.5px;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        .checkout-info {\r\n            padding-left: 25px;\r\n            padding-bottom: 15px;\r\n            margin-bottom: 10px;\r\n            border: 2px solid #e1251b;\r\n\r\n            h4 {\r\n                margin: 9px 0;\r\n                font-size: 14px;\r\n                line-height: 21px;\r\n                color: #e1251b;\r\n            }\r\n\r\n            ol {\r\n                padding-left: 25px;\r\n                list-style-type: decimal;\r\n                line-height: 24px;\r\n                font-size: 14px;\r\n            }\r\n\r\n            ul {\r\n                padding-left: 25px;\r\n                list-style-type: disc;\r\n                line-height: 24px;\r\n                font-size: 14px;\r\n            }\r\n        }\r\n\r\n        .checkout-steps {\r\n            border: 1px solid #ddd;\r\n            padding: 25px;\r\n\r\n            .hr {\r\n                height: 1px;\r\n                background-color: #ddd;\r\n            }\r\n\r\n            .step-tit {\r\n                line-height: 36px;\r\n                margin: 15px 0;\r\n            }\r\n\r\n            .step-cont {\r\n                margin: 0 10px 12px 20px;\r\n\r\n                ul {\r\n                    font-size: 0;\r\n\r\n                    li {\r\n                        margin: 2px;\r\n                        display: inline-block;\r\n                        padding: 5px 20px;\r\n                        border: 1px solid #ddd;\r\n                        cursor: pointer;\r\n                        line-height: 18px;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        .submit {\r\n            text-align: center;\r\n\r\n            .btn {\r\n                display: inline-block;\r\n                padding: 15px 45px;\r\n                margin: 15px 0 10px;\r\n                font: 18px \"微软雅黑\";\r\n                font-weight: 700;\r\n                border-radius: 0;\r\n                background-color: #e1251b;\r\n                border: 1px solid #e1251b;\r\n                color: #fff;\r\n                text-align: center;\r\n                vertical-align: middle;\r\n                cursor: pointer;\r\n                user-select: none;\r\n                text-decoration: none;\r\n            }\r\n        }\r\n    }\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}