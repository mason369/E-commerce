{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { mapState } from \"vuex\";\nexport default {\n  name: \"Trade\",\n  data() {\n    return {\n      msg: \"\",\n      //收集买家的留言信息\n      orderId: \"\" //订单号\n    };\n  },\n\n  mounted() {\n    this.$store.dispatch(\"getUserAddress\");\n    this.$store.dispatch(\"getOrderInfo\");\n  },\n  computed: {\n    ...mapState({\n      addressInfo: state => state.trade.address,\n      orderInfo: state => state.trade.orderInfo\n    }),\n    //将来提交订单最终选中地址\n    userDefaultAddress() {\n      //find:查找数组当中符合条件的元素返回，最为最终结果\n      return this.addressInfo.find(item => item.isDefault == 1) || {};\n    }\n  },\n  methods: {\n    //修改默认地址\n    changeDefault(address, addressInfo) {\n      addressInfo.forEach(item => {\n        //全部的为0\n        item.isDefault = 0;\n      });\n      address.isDefault = 1; //点击的为1\n    },\n\n    //提交订单\n    async submitOrder() {\n      //交易编码\n      let {\n        tradeNo\n      } = this.orderInfo;\n      //其余的六个参数\n      let data = {\n        consignee: this.userDefaultAddress.consignee,\n        //最终收件人的名字\n        consigneeTel: this.userDefaultAddress.phoneNum,\n        //最终收件人的手机号\n        deliveryAddress: this.userDefaultAddress.fullAddress,\n        //收件人的地址\n        paymentWay: \"ONLINE\",\n        //支付方式\n        orderComment: this.msg,\n        //买家的留言信息\n        orderDetailList: this.orderInfo.detailArrayList //商品清单\n      };\n      //需要带参数的：tradeNo\n      let result = await this.$API.reqSubmitOrder(tradeNo, data);\n      // console.log(result);\n      if (result.code == 200) {\n        this.orderId = result.data,\n        //路由跳转 + 路由传递参数\n        this.$router.push(\"/pay?orderId=\" + this.orderId);\n      } else {\n        alert(result.data + \"不能重复提交订单\");\n      }\n    }\n  }\n};","map":{"version":3,"mappings":";AA8FA;AAEA;EACAA;EACAC;IACA;MACAC;MAAA;MACAC;IACA;EACA;;EACAC;IACA;IACA;EACA;EACAC;IACA;MACAC;MACAC;IACA;IACA;IACAC;MACA;MACA;IACA;EACA;EACAC;IACA;IACAC;MACAJ;QACA;QACAK;MACA;MACAC;IACA;;IACA;IACA;MACA;MACA;QAAAC;MAAA;MACA;MACA;QACAC;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;QAAA;QACAC;MACA;MACA;MACA;MACA;MACA;QACA;QACA;QACA;MACA;QACAC;MACA;IACA;EACA;AACA","names":["name","data","msg","orderId","mounted","computed","addressInfo","orderInfo","userDefaultAddress","methods","changeDefault","item","address","tradeNo","consignee","consigneeTel","deliveryAddress","paymentWay","orderComment","orderDetailList","alert"],"sourceRoot":"src/pages/Trade","sources":["index.vue"],"sourcesContent":["<template>\r\n    <div class=\"trade-container\">\r\n        <h3 class=\"title\">填写并核对订单信息</h3>\r\n        <div class=\"content\">\r\n            <h5 class=\"receive\">收件人信息</h5>\r\n            <div class=\"address clearFix\" v-for=\"(address, index) in addressInfo\" :key=\"address.id\">\r\n                <span class=\"username\" :class=\"{ selected: address.isDefault == 1 }\">{{ address.consignee }}</span>\r\n                <p @click=\"changeDefault(address, addressInfo)\">\r\n                    <span class=\"s1\">{{ address.fullAddress }}</span>\r\n                    <span class=\"s2\">{{ address.phoneNum }}</span>\r\n                    <span class=\"s3\" v-show=\"address.isDefault == 1\">默认地址</span>\r\n                </p>\r\n            </div>\r\n            <div class=\"line\"></div>\r\n            <h5 class=\"pay\">支付方式</h5>\r\n            <div class=\"address clearFix\">\r\n                <span class=\"username selected\">在线支付</span>\r\n                <span class=\"username\" style=\"margin-left: 5px\">货到付款</span>\r\n            </div>\r\n            <div class=\"line\"></div>\r\n            <h5 class=\"pay\">送货清单</h5>\r\n            <div class=\"way\">\r\n                <h5>配送方式</h5>\r\n                <div class=\"info clearFix\">\r\n                    <span class=\"s1\">天天快递</span>\r\n                    <p>配送时间：预计8月10日（周三）09:00-15:00送达</p>\r\n                </div>\r\n            </div>\r\n            <div class=\"detail\">\r\n                <h5>商品清单</h5>\r\n                <ul class=\"list clearFix\" v-for=\"(order, index) in orderInfo.detailArrayList\" :key=\"order.skuid\">\r\n                    <li>\r\n                        <img :src=\"order.imgUrl\" alt=\"\" style=\"width: 100px; height: 100px\" />\r\n                    </li>\r\n                    <li>\r\n                        <p>{{ order.skuName }}</p>\r\n                        <h4>7天无理由退货</h4>\r\n                    </li>\r\n                    <li>\r\n                        <h3>￥{{ order.orderPrice }}.00</h3>\r\n                    </li>\r\n                    <li>X{{ order.skuNum }}</li>\r\n                    <li>有货</li>\r\n                </ul>\r\n            </div>\r\n            <div class=\"bbs\">\r\n                <h5>买家留言：</h5>\r\n                <textarea placeholder=\"建议留言前先与商家沟通确认\" class=\"remarks-cont\" v-model=\"msg\"></textarea>\r\n            </div>\r\n            <div class=\"line\"></div>\r\n            <div class=\"bill\">\r\n                <h5>发票信息：</h5>\r\n                <div>普通发票（电子） 个人 明细</div>\r\n                <h5>使用优惠/抵用</h5>\r\n            </div>\r\n        </div>\r\n        <div class=\"money clearFix\">\r\n            <ul>\r\n                <li>\r\n                    <b\r\n                        ><i>{{ orderInfo.totalNum }}</i\r\n                        >件商品，总商品金额</b\r\n                    >\r\n                    <span>¥{{ orderInfo.totalAmount }}.00</span>\r\n                </li>\r\n                <li>\r\n                    <b>返现：</b>\r\n                    <span>0.00</span>\r\n                </li>\r\n                <li>\r\n                    <b>运费：</b>\r\n                    <span>0.00</span>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n        <div class=\"trade\">\r\n            <div class=\"price\">\r\n                应付金额:　<span>¥{{ orderInfo.totalAmount }}.00</span>\r\n            </div>\r\n            <div class=\"receiveInfo\">\r\n                寄送至:\r\n                <span>{{ userDefaultAddress.fullAddress }}</span>\r\n                收货人：<span>{{ userDefaultAddress.consignee }}</span>\r\n                <span>{{ userDefaultAddress.phoneNum }}</span>\r\n            </div>\r\n        </div>\r\n        <div class=\"sub clearFix\">\r\n            <!--            <router-link class=\"subBtn\" to=\"/pay\" @click=\"\">提交订单</router-link>-->\r\n            <a class=\"subBtn\" @click=\"submitOrder\">提交订单</a>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState } from \"vuex\";\r\n\r\nexport default {\r\n    name: \"Trade\",\r\n    data() {\r\n        return {\r\n            msg: \"\", //收集买家的留言信息\r\n            orderId: \"\", //订单号\r\n        };\r\n    },\r\n    mounted() {\r\n        this.$store.dispatch(\"getUserAddress\");\r\n        this.$store.dispatch(\"getOrderInfo\");\r\n    },\r\n    computed: {\r\n        ...mapState({\r\n            addressInfo: (state) => state.trade.address,\r\n            orderInfo: (state) => state.trade.orderInfo,\r\n        }),\r\n        //将来提交订单最终选中地址\r\n        userDefaultAddress() {\r\n            //find:查找数组当中符合条件的元素返回，最为最终结果\r\n            return this.addressInfo.find((item) => item.isDefault == 1) || {};\r\n        },\r\n    },\r\n    methods: {\r\n        //修改默认地址\r\n        changeDefault(address, addressInfo) {\r\n            addressInfo.forEach((item) => {\r\n                //全部的为0\r\n                item.isDefault = 0;\r\n            });\r\n            address.isDefault = 1; //点击的为1\r\n        },\r\n        //提交订单\r\n        async submitOrder() {\r\n            //交易编码\r\n            let { tradeNo } = this.orderInfo;\r\n            //其余的六个参数\r\n            let data = {\r\n                consignee: this.userDefaultAddress.consignee, //最终收件人的名字\r\n                consigneeTel: this.userDefaultAddress.phoneNum, //最终收件人的手机号\r\n                deliveryAddress: this.userDefaultAddress.fullAddress, //收件人的地址\r\n                paymentWay: \"ONLINE\", //支付方式\r\n                orderComment: this.msg, //买家的留言信息\r\n                orderDetailList: this.orderInfo.detailArrayList, //商品清单\r\n            };\r\n            //需要带参数的：tradeNo\r\n            let result = await this.$API.reqSubmitOrder(tradeNo, data);\r\n            // console.log(result);\r\n            if (result.code == 200) {\r\n                (this.orderId = result.data),\r\n                    //路由跳转 + 路由传递参数\r\n                    this.$router.push(\"/pay?orderId=\" + this.orderId);\r\n            } else {\r\n                alert(result.data+\"不能重复提交订单\");\r\n            }\r\n        },\r\n    },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.clearFix:after {\r\n    visibility: hidden;\r\n    display: block;\r\n    font-size: 0;\r\n    content: \" \";\r\n    clear: both;\r\n    height: 0;\r\n}\r\n\r\n.trade-container {\r\n    .title {\r\n        width: 1200px;\r\n        margin: 0 auto;\r\n        font-size: 14px;\r\n        line-height: 21px;\r\n    }\r\n\r\n    .content {\r\n        width: 1200px;\r\n        margin: 10px auto 0;\r\n        border: 1px solid rgb(221, 221, 221);\r\n        padding: 25px;\r\n        box-sizing: border-box;\r\n\r\n        .receive,\r\n        .pay {\r\n            line-height: 36px;\r\n            margin: 18px 0;\r\n        }\r\n\r\n        .address {\r\n            padding-left: 20px;\r\n            margin-bottom: 15px;\r\n\r\n            .username {\r\n                float: left;\r\n                width: 100px;\r\n                height: 30px;\r\n                line-height: 30px;\r\n                text-align: center;\r\n                border: 1px solid #ddd;\r\n                position: relative;\r\n            }\r\n\r\n            .username::after {\r\n                content: \"\";\r\n                display: none;\r\n                width: 13px;\r\n                height: 13px;\r\n                position: absolute;\r\n                right: 0;\r\n                bottom: 0;\r\n                background: url(./images/choosed.png) no-repeat;\r\n            }\r\n\r\n            .username.selected {\r\n                border-color: #e1251b;\r\n            }\r\n\r\n            .username.selected::after {\r\n                display: block;\r\n            }\r\n\r\n            p {\r\n                width: 610px;\r\n                float: left;\r\n                line-height: 30px;\r\n                margin-left: 10px;\r\n                padding-left: 5px;\r\n                cursor: pointer;\r\n\r\n                .s1 {\r\n                    float: left;\r\n                }\r\n\r\n                .s2 {\r\n                    float: left;\r\n                    margin: 0 5px;\r\n                }\r\n\r\n                .s3 {\r\n                    float: left;\r\n                    width: 90px;\r\n                    height: 24px;\r\n                    line-height: 24px;\r\n                    margin-left: 10px;\r\n                    background-color: #878787;\r\n                    color: #fff;\r\n                    margin-top: 3px;\r\n                    text-align: center;\r\n                }\r\n            }\r\n\r\n            p:hover {\r\n                background-color: #ddd;\r\n            }\r\n        }\r\n\r\n        .line {\r\n            height: 1px;\r\n            background-color: #ddd;\r\n        }\r\n\r\n        .way {\r\n            width: 1080px;\r\n            height: 110px;\r\n            background: #f4f4f4;\r\n            padding: 15px;\r\n            margin: 0 auto;\r\n\r\n            h5 {\r\n                line-height: 50px;\r\n            }\r\n\r\n            .info {\r\n                margin-top: 20px;\r\n\r\n                .s1 {\r\n                    float: left;\r\n                    border: 1px solid #ddd;\r\n                    width: 120px;\r\n                    height: 30px;\r\n                    line-height: 30px;\r\n                    text-align: center;\r\n                    margin-right: 10px;\r\n                }\r\n\r\n                p {\r\n                    line-height: 30px;\r\n                }\r\n            }\r\n        }\r\n\r\n        .detail {\r\n            width: 1080px;\r\n\r\n            background: #feedef;\r\n            padding: 15px;\r\n            margin: 2px auto 0;\r\n\r\n            h5 {\r\n                line-height: 50px;\r\n            }\r\n\r\n            .list {\r\n                display: flex;\r\n                justify-content: space-between;\r\n\r\n                li {\r\n                    line-height: 30px;\r\n\r\n                    p {\r\n                        margin-bottom: 20px;\r\n                    }\r\n\r\n                    h4 {\r\n                        color: #c81623;\r\n                        font-weight: 400;\r\n                    }\r\n\r\n                    h3 {\r\n                        color: #e12228;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        .bbs {\r\n            margin-bottom: 15px;\r\n\r\n            h5 {\r\n                line-height: 50px;\r\n            }\r\n\r\n            textarea {\r\n                width: 100%;\r\n                border-color: #e4e2e2;\r\n                line-height: 1.8;\r\n                outline: none;\r\n                resize: none;\r\n            }\r\n        }\r\n\r\n        .bill {\r\n            h5 {\r\n                line-height: 50px;\r\n            }\r\n\r\n            div {\r\n                padding-left: 15px;\r\n            }\r\n        }\r\n    }\r\n\r\n    .money {\r\n        width: 1200px;\r\n        margin: 20px auto;\r\n\r\n        ul {\r\n            width: 220px;\r\n            float: right;\r\n\r\n            li {\r\n                line-height: 30px;\r\n                display: flex;\r\n                justify-content: space-between;\r\n\r\n                i {\r\n                    color: red;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    .trade {\r\n        box-sizing: border-box;\r\n        width: 1200px;\r\n        padding: 10px;\r\n        margin: 10px auto;\r\n        text-align: right;\r\n        background-color: #f4f4f4;\r\n        border: 1px solid #ddd;\r\n\r\n        div {\r\n            line-height: 30px;\r\n        }\r\n\r\n        .price span {\r\n            color: #e12228;\r\n            font-weight: 700;\r\n            font-size: 14px;\r\n        }\r\n\r\n        .receiveInfo {\r\n            color: #999;\r\n        }\r\n    }\r\n\r\n    .sub {\r\n        width: 1200px;\r\n        margin: 0 auto 10px;\r\n\r\n        .subBtn {\r\n            float: right;\r\n            width: 164px;\r\n            height: 56px;\r\n            font: 700 18px \"微软雅黑\";\r\n            line-height: 56px;\r\n            text-align: center;\r\n            color: #fff;\r\n            background-color: #e1251b;\r\n        }\r\n    }\r\n}\r\n</style>\r\n"]},"metadata":{},"sourceType":"module"}